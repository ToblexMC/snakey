<!doctype html>
<body>
    <canvas id="gameCanvas" width="900" height="900"></canvas>
    <script>
        var name = prompt("Set username");
        alert("Hello "+ name + ", hope you enjoy");
        var canvas, canvasContext;

        window.onload = function() {
            canvas = document.getElementById('gameCanvas');
            canvasContext = canvas.getContext('2d');

            document.addEventListener('keydown', keyPressed);
            document.addEventListener('keyup', keyReleased);

            setInterval(mainloop, 1000 / 100);
        }

        var wormsize = 20; 
        var wormXpos = 450;
        var wormYpos = 450; 
        var speed = 3;
        var wormColour = "lime"

        var colour = "white"

        var leftKeyPressed = false;
        var rightKeyPressed = false;
        var upKeyPressed = false;
        var downKeyPressed = false;

        const left = 37;
        const right = 39;
        const up = 38;
        const down = 40;

        var finishLoc = 800;

        var counter = 1;

        var highscore = 0;
        var highscoreLoc = 900;
        var hsIncrease = wormsize - highscore;
        var highscoreBest = "You bet your highscore by " + hsIncrease + "!";
        var hcBestLoc = 900;


        var yummyXpos = 120;
        var yummyYpos = 300;
        var yummySize = 35; 
        var yummyColour = "red";

        var nameColour = "white";

        function mainloop() {
            colorRect(0,0,canvas.width,canvas.height,'black'); // background color
            colorRect(wormXpos,wormYpos,wormsize,wormsize,wormColour); //bloby
            colorRect(yummyXpos,yummyYpos,yummySize,yummySize,yummyColour);
           
            drawText(755,20,300,100,colour, 'Countdown:' + counter); //countdown
            drawText(hcBestLoc,480,300,100,colour, highscoreBest); //highscore amout
            drawText(2,20,300,100,'white', 'Size:' + wormsize); //Size Counter
            drawText(finishLoc,finishLoc,300,100,'white', 'Score: ' + wormsize); //finish
            drawText(highscoreLoc,440,300,100,'white', 'Highscore: ' + highscore); //highscore
            drawText(wormXpos - 2,wormYpos - 10,300,100,nameColour, name); //Name

            move();
            yummyRandomPos();
            count();
            colourSet();
            finish();
        }

        function finish(){
            if(counter < 0.1){
                yummyColour = "black";
                wormColour = "black";
                nameColour = "black";
                wormXpos = 800;
                finishLoc = 400;
               
                if(wormsize > highscore){
                    highscore = wormsize;
                }

                highscoreLoc = 390;
                hcBestLoc = 320;

            }

        }


        function keyPressed(evt){
            if(evt.keyCode == left){
                leftKeyPressed = true;
            }
            if(evt.keyCode == right){
                rightKeyPressed = true;
            }
            if(evt.keyCode == up){
                upKeyPressed = true;
            }
            if(evt.keyCode == down){
                downKeyPressed = true;
            }
        }

        function move(){
            if(leftKeyPressed == true && wormXpos > 0 && counter > 0){
                wormXpos = wormXpos - speed;
            }
            if(rightKeyPressed == true && wormXpos < canvas.width - wormsize && counter > 0){
                wormXpos = wormXpos + speed;
            }
            if(upKeyPressed == true && wormYpos > 0 && counter > 0){
                wormYpos = wormYpos - speed;
            }
            if(downKeyPressed == true && wormYpos < canvas.height - wormsize && counter > 0){
                wormYpos = wormYpos + speed;
            }
        }

        function keyReleased(evt) {
            if(evt.keyCode == left){
                leftKeyPressed = false;
            }
            if(evt.keyCode == right){
                rightKeyPressed = false;
            }
            if(evt.keyCode == up){
                upKeyPressed = false;
            }
            if(evt.keyCode == down){
                downKeyPressed = false;
            }
        }

        function yummyRandomPos(){
            if(yummyYpos + wormsize > wormYpos && yummyYpos < wormYpos + wormsize && yummyXpos + yummySize > wormXpos && yummyXpos < wormXpos + wormsize){
                yummyXpos = Math.floor(Math.random()*(900 - yummySize));
                yummyYpos = Math.floor(Math.random()*(900 - yummySize));
                wormsize = wormsize + 2;
                speed = speed + .1; 

            }

        }

        function count(){
            if(counter > 0){
            counter = counter - 0.01;
            }
            if(counter < 0){
                counter = 0
            }
            
        }

        function colourSet(){
            if(counter < 31 && counter > 21){
                colour = "yellow";
            }

            if(counter < 21 && counter > 11){
                colour = "orange";
            }

            if (counter < 11){
                colour = "red"
            }
        }


        function colorRect(x,y,w,h,c){
            canvasContext.fillStyle = c;5409+94*9+5*8-20388-5878490
            canvasContext.fillRect(x,y,w,h);
        }

        function drawText(x,y,w,h,color, msg){
            canvasContext.fillStyle = color;
            canvasContext.fillText(msg,x,y,w,h);
            canvasContext.font = "20px Arial";
        }
 
    </script>
</body>